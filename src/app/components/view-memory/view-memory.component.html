<div [ngSwitch]="showHideMemoryForm">
  <div *ngSwitchCase="showHideTagForm">
    <div *ngFor="let item of formArray">
      <form
        [formGroup]="tagForm"
        (ngSubmit)="handleTag(tagForm, inputValue.value)"
      >
        <button (click)="closeTag()">X</button>
        <h1>Add Tag Form</h1>
        <input type="text" name="id" value="{{ item.id }}" #inputValue hidden />
        <div class="form-group">
          <label>Add a TAG</label>
          <input
            type="text"
            class="form-control"
            formControlName="tagName"
            placeholder="Tag"
          />
        </div>
        <button type="submit">SubmitTag</button>
      </form>
    </div>
  </div>
  <div *ngSwitchCase="showHideEditForm">
    <div *ngFor="let item of formArray">
      <form #myForm>
        <button (click)="closeEditDelete()">X</button>
        <h1>Edit Form</h1>
        <input type="text" name="id" value="{{ item.id }}" hidden />
        <div class="form-group">
          <label>Title</label>
          <input
            class="form-control"
            type="text"
            name="title"
            value="{{ item.title }}"
          />
        </div>

        <div class="form-group">
          <label>Memory</label>
          <textarea
            class="form-control"
            type="text"
            name="memory"
            value="{{ item.memory }}"
          ></textarea>
        </div>

        <div class="form-group">
          <label>Due Date</label>
          <input
            class="form-control"
            type="date"
            name="dueDate"
            value="{{ item.dueDate }}"
          />
        </div>

        <button (click)="handleEdit(myForm)">UPDATE</button>
      </form>
    </div>
  </div>
  <div *ngSwitchDefault>
    <app-post-memory></app-post-memory>
  </div>
</div>

<ng-container>
  <!-- Search Input -->
  <div class="search-input-wrapper">
    <input
      class="form-control"
      type="text"
      placeholder="Search Title"
      [(ngModel)]="searchTerm"
      (keyup)="onSearch($event)"
    />
  </div>

  <!-- spinner -->
  <ng-container *ngIf="memories.length === 0">
    <div class="spinner-wrapper">
      <app-loading-spinner></app-loading-spinner>
    </div>
  </ng-container>

  <!-- Memories -->
  <ng-container *ngIf="memories.length > 0">
    <div class="memories-wrapper">
      <div
        class="memory-wrapper"
        *ngFor="let item of memories | memorySearch: searchTerm"
      >
        <div class="tag-wrapper">
          <div>
            <button class="primary-colour" (click)="showHideTag()">
              Add Tag
            </button>
          </div>

          <div class="tagS-wrapper">
            <div *ngFor="let tag of tags">
              <ng-container *ngIf="item.id === tag.memoryId">
                <div class="tag">
                  <span class="inner-tag">
                    {{ tag.tagName }}
                  </span>
                </div>
              </ng-container>
            </div>
          </div>
        </div>

        <!-- <div *ngIf="item.dueDate !== '0000-00-00'; else notSet">
          <p class="small-text">
            This task is due in {{ item.dueDate | timeTo }}
          </p>
          <ng-template #notSet>No reminder set</ng-template>
        </div> -->

        <div
          *ngIf="
            item.dueDate !== '0000-00-00';
            then content;
            else other_content
          "
        ></div>
        <ng-template #content>
          <p class="medium-text">
            <span [ngClass]="{ reminder: item.dueDate < now }">
              Due {{ item.dueDate | timeTo }}
            </span>
          </p></ng-template
        >
        <ng-template #other_content>
          <p class="small-text">
            No reminder set
          </p>
        </ng-template>

        <h1 class="heading">{{ item.title }}</h1>
        <p>{{ item.memory }}</p>

        <div class="button-wrapper">
          <button class="warning-colour" (click)="showEditForm(item)">
            EDIT
          </button>
          <button class="danger-colour" (click)="deleteMemory(item.id)">
            DELETE
          </button>
        </div>
        <small class="small-text"> {{ item.posted }}</small>
      </div>
    </div>
  </ng-container>
</ng-container>
<hr />
